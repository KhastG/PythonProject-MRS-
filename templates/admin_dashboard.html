<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='dashboard.css') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="icon" type="image/png"  href="{{ url_for('static', filename='website_images/maintenance_ticket.png') }}">
</head>
<body>
<header style="background-color:#f28b82; color: white; padding: 20px;">
    <div class="d-flex justify-content-between align-items-center">
        <div class="title">
        <h1 style="font-weight: bold;">MAINTENANCE TICKETING SYSTEM</h1>
        <p>ALL-IN-ONE MAINTENANCE TICKET SUBMISSION</p>
    </div>
        <a class="logout-link" href="{{ url_for('logout') }}"
        style="background-color: rgba(255,255,255,0.3); color: white; padding: 8px 16px; border-radius: 6px; text-decoration: none;">
        LOG OUT
    </a>
    </div>
</header>

<div class="container mt-4 mb-5">
<!-- SEARCH BAR -->
<form method="GET" action="{{ url_for('search_users') }}" class="d-flex mb-4" role="search">
    <input class="form-control me-2" type="search" name="q" placeholder="Search users..." aria-label="Search" required>
    <button class="btn btn-outline-primary" type="submit">Search</button>
</form>

<!-- ADMIN INFO -->
<div class="user-info mb-4">
    <h3>Welcome, {{ user.first_name }} {{ user.last_name }}!</h3>
    <p>Your role: <strong>{{ user.role|upper }}</strong></p>
</div>

<!-- USERS TABLE -->
<div class="card shadow-sm mb-5">
    <div class="card-header bg-danger text-white fw-semibold">
        All Users
    </div>
    <div class="card-body p-1">
        <table class="table table-striped mb-0"> <!-- this makes the code to look like it has a horizontal line and has a table formatting-->
            <thead class="table-light">
                <tr>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Role</th>
                    <th>Username</th>
                    <th>Email</th>
                </tr>
            </thead>
            <tbody>
                {% for user in users %}
                <tr>
                    <td>{{ user.first_name }}</td>
                    <td>{{ user.last_name }}</td>
                    <td>{{ user.role | capitalize}}</td>
                    <td>{{ user.username }}</td>
                    <td>{{ user.email }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- FILTERS -->
<div class="d-flex gap-2 align-items-center mb-3">
    <select id="deptFilter" class="form-select" style="width: 200px;">
        <option value="All">All Departments</option>
        <option value="Electrical">Electrical</option>
        <option value="Plumbing">Plumbing</option>
        <option value="Carpentry">Carpentry</option>
    </select>

    <select id="statusFilter" class="form-select" style="width: 200px;">
        <option value="All">All Status</option>
        <option value="Pending">Pending</option>
        <option value="Approved">Approved</option>
        <option value="Done">Done</option>
    </select>

    <select id="sortOrder" class="form-select" style="width: 250px;">
        <option selected>SORT ID</option>
        <option value="desc">Descending (Newest first)</option>
        <option value="asc">Ascending (Oldest first)</option>
    </select>
</div>
<!-- TICKETS TABLE -->
<div class="card shadow-sm">
    <div class="card-header bg-danger text-white fw-semibold">
        All Tickets
    </div>
    <div class="card-body p-0">
        <table class="table table-hover mb-0" id="ticketTable">
            <thead class="table-light">
                <tr>
                    <th>ID</th>
                    <th>Employee</th>
                    <th>Department</th>
                    <th>Description</th>
                    <th>Date Submitted</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody id="ticketBody">
                {% for ticket in tickets %}
                <tr>
                    <td>{{ ticket.id }}</td>
                    <td>{{ ticket.submitted_name }}</td>
                    <td>{{ ticket.category }}</td>
                    <td>{{ ticket.description }}</td>
                    <td>{{ ticket.status }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

</div>

<footer>
    <p class="mb-0 text-center">&copy; 2025 | Designed by Poging Noy TEOPE</p>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="{{ url_for('static', filename='admin_dashboard.js') }}"></script>
</body>
</html>
