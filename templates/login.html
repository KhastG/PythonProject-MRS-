<!DOCTYPE html>
<html>
<head>
    <title>Login</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/login.css') }}">
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='website_images/maintenance_ticket.png') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
<header style="background-color:#f28b82; color: white; padding: 20px;">
    <div class="d-flex justify-content-between align-items-center">
        <div class="title">
            <h1 style="font-weight: bold;">MAINTENANCE TICKETING SYSTEM</h1>
            <p>ALL-IN-ONE MAINTENANCE TICKET SUBMISSION</p>
        </div>
    </div>
</header>
<div id="main-content-wrapper">
    <div class="form-box">
        <h2>Login Page</h2>
        <form method="POST">
            <label for="username">Username:</label><br>
            <input type="text" id="username" name="username" required><br><br>

            <label for="password">Password:</label><br>
            <div class="password-container">
                <input type="password" id="password" name="password" required>
                <button type="button" class="show-password-btn" id="togglePassword">
                    <i class="fas fa-eye-slash"></i>
                </button>
            </div>
            <br><br>
            <button type="submit">Login</button>
        </form>
        <p><a href="#" id="forgotPasswordLink">Forgot Password?</a></p>
        <p>Donâ€™t have an account? <a href="{{ url_for('signup') }}">Sign Up</a></p>
    </div>

    <footer style="color: white; text-align: center; background-color: transparent; margin-top: auto;">
        <p class="mb-0">&copy; 2025 | Maintenance Ticketing System</p>
    </footer>
</div>
{% if login_error %}
<input type="hidden" id="loginError" value="{{ login_error }}">
{% endif %}

<!-- FORGOT PASSWORD: ENTER EMAIL MODAL -->
<div id="forgotPasswordModal" class="modal-overlay">
    <div class="modal-box">
        <h3>Reset Password</h3>
        <p>Enter your email address to receive an OTP.</p>

        <input type="email" id="fp_email" placeholder="Email" required>

        <button id="sendOtpBtn">Send OTP</button>
        <button class="closeModal">Cancel</button>
    </div>
</div>

<!-- ENTER OTP MODAL -->
<div id="enterOtpModal" class="modal-overlay">
    <div class="modal-box">
        <h3>Verify OTP</h3>
        <p>We have sent a code to your email. Please enter it below.</p>

        <input type="text" id="otp_input" placeholder="Enter 6-digit Code" maxlength="6" required
               style="text-align: center; letter-spacing: 5px; font-weight: bold; font-size: 18px;">

        <button id="verifyOtpBtn">Verify & Proceed</button>
        <button class="closeModal">Cancel</button>
    </div>
</div>

<!-- RESET PASSWORD MODAL -->
<div id="resetPasswordModal" class="modal-overlay">
    <div class="modal-box">
        <h3>Set New Password</h3>
        <p>Please enter your new password.</p>

        <!-- New Password Field -->
        <div class="password-container" style="margin-bottom: 15px;">
            <input type="password" id="rp_new_password" placeholder="New Password" required>
            <button type="button" class="show-password-btn toggle-rp">
                <i class="fas fa-eye-slash"></i>
            </button>
        </div>

        <!-- Confirm Password Field -->
        <div class="password-container">
            <input type="password" id="rp_confirm_password" placeholder="Confirm Password" required>
            <button type="button" class="show-password-btn toggle-rp">
                <i class="fas fa-eye-slash"></i>
            </button>
        </div>

        <button id="savePasswordBtn" style="margin-top: 20px;">Reset Password</button>
        <button class="closeModal">Cancel</button>
    </div>
</div>

<!-- SUCCESS MODAL -->
<div id="successModal" class="modal-overlay">
    <div class="modal-box" style="border-top: 5px solid #28a745;">
        <h3 style="color: #28a745;">Success!</h3>
        <p>Your password has been reset successfully.</p>
        <p>You can now login with your new password.</p>
        <button id="closeSuccessBtn" style="background-color: #28a745;">Go to Login</button>
    </div>
</div>

<!-- ERROR MODAL -->
<div id="errorModal" class="modal-overlay">
    <div class="modal-box">
        <h3>Invalid Input</h3>
        <p id="errorMessage"></p>
        <button id="closeModalBtn">OK</button>
    </div>
</div>

<script src="{{ url_for('static', filename='js/login.js') }}"></script>
</body>
</html>
